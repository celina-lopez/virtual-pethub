{% extends "layout.html" %}
{% block body %}

<div class="container py-5 mb-3 content" x-data="{}">
  <div class="text-end mb-4">
    <div style="font-size: 2em; cursor: pointer;" x-on:click="location.href='https://github.com/celina-lopez/virtual-pethub'">
      <i class="fab fa-github"></i>
    </div>
  </div>
  <div class="text-center mb-4">
    <div class="h1 text-center fancy-font">
      Virtual Pet<span class="text-main">Hub</span>
    </div>
    <i>A virtual pet based on your contributions</i>
  </div>

  <h3 class="mt-4">First, enter your github username</h3>
  <input type="text" class="form-control form-control-lg" placeholder="Github username" name="username" id="username">
  <input type="hidden" id="pet" name="pet" value="{{ pets[0] }}" />
  <input type="hidden" id="theme" name="theme" value="pink" />

  <h3 class="mt-4">Choose a pet</h3>
  <div class="row">
    {% for pet in pets %}
      <div class="col-4 my-2 text-center pet" data-pet="{{ pet }}">
        <img src="https://www.virtual-pethub.com/static/{{ pet }}/dancing-rainbow.gif" height="200" />
        <div>{{ pet }}</div>
      </div>
    {% endfor %}
  </div>

  <h3 class="mt-4">Now a device</h3>
  <div class="row mb-2">
    {% for theme in themes.keys() %}
      <div class="col-4 my-2 text-center theme" data-theme="{{ theme }}">
        <img
          class="pet-pic"
          src="https://www.virtual-pethub.com/static/{{ pets[0] }}/dancing-{{ theme }}.gif"
          height="200"
          data-theme="{{ theme }}"
        />
        <div>{{ theme }}</div>
      </div>
    {% endfor %}
  </div>
  <button class="btn btn-main w-100 btn-lg mt-3" id="submit">Create</button>


</div>
<script>

  function handleSelect(name, thiz) {
    const value = $(thiz).data(name);
    $('#' + name).val(value);
    $("." + name).each(function(){
      $(this).removeClass("active")
    })
    $(thiz).addClass("active");
  } 

  $('.pet').click(function() {
    handleSelect("pet", this)
    const val = $("#pet").val()
    $(".pet-pic").each(function(){
      $(this).attr("src", "https://www.virtual-pethub.com/static/" + val  + "/dancing-"+ $(this).data("theme") + ".gif")
    })
  });

  $('.theme').click(function() {
    handleSelect("theme", this)
  });



  $(function() {
    $("#submit").click(function() {
      window.location.href = `/${$('#username').val().toLowerCase()}?theme=${$('#theme').val()}&pet=${$("#pet").val()}`
    });
  });
</script>

<div class="footer-copyright text-center py-3">
  <i>Made with <a target="_blank" href="https://forever-free-cloud-app-starter.chriszhu.me/">forever free cloud app starter</a></i>
</div>



{% endblock %}
